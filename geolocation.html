<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>weather</title>

    <link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet">
    <link rel="stylesheet" href="ajax.css">
  </head>

  <body>

      <header>

      </header>

      <section>

      </section>

    <script>
    var header = document.querySelector('header');
    var section = document.querySelector('section');
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else {
      //if geolocation fails
    }
    function showFood(jsonObj) {
      var jsonHits = jsonObj['hits'];
      //randomises the recipe to show from 0 - 9
      var randomRec = Math.floor((Math.random() * 10));
      //jsonRecepie is where the information from one recepie gathers. info an be called by jsonRecepie.Whateverinfo
      jsonRecepie = jsonHits[randomRec].recipe;
      var name = jsonRecepie.label;
      var instruction = jsonRecepie.url;
      var image = jsonRecepie.image;
      var source = jsonRecepie.source;
      // is a list
      var healthLabelList = jsonRecepie.healthLabels;
      //is a list
      var ingredientsList = jsonRecepie.ingredientLines;
      var calories = jsonRecepie.calories;
      var myH2 = document.createElement('h2');
      myH2.textContent = name;
      header.appendChild(myH2);
    }
    function showWeather(jsonObj){
      var jsonWeather = jsonObj['weather'][0].main;
      var jsonTemp = jsonObj['main'].temp;
      var jsonName = jsonObj['name'];
      //get information by jsonWeather."Whateverinfo"
      var myH1 = document.createElement('h1');
      myH1.textContent = jsonWeather;
      header.appendChild(myH1);
    }

    function showPosition(position) {
      var jsonTemp = '0';
      var requestURL = 'http://api.openweathermap.org/data/2.5/weather?lat=';
      var appID = '&APPID=20bb47a9e07cd3fd298fe2dd460ce3eb';
      var request = new XMLHttpRequest();
      var search = requestURL + Math.round(position.coords.latitude) +'&lon='+ Math.round(position.coords.longitude) + appID;
      request.open('GET', search);
      request.responseType = 'json';
      request.send();
      request.onload = function() {
        var response = request.response;
        weatherOK(response);
      }
    }
    function weatherOK(jsonObj) {
      var requestURL2 = 'https://api.edamam.com/search';
      var appID2 = 'ac5c8b15';
      var appKey2 = 'bda8334a6603c154a512182b7290dc6e';
      var request2 = new XMLHttpRequest();
      var searchWord = 'soup';
      /*
      if(parseInt(jsonTemp, 10) < 280){
        searchWord = 'soup';
      }else {
        searchWord = 'grilled';
      }
      */
      var search2 =  requestURL2+'?q=' + searchWord + '&app_id=' + appID2 + '&app_key=' + appKey2;
      request2.open('GET', search2);
      request2.responseType = 'json';
      request2.send();
      request2.onload = function() {
        var response = request2.response;
        showFood(response);
        showWeather(jsonObj);
      }
    }
    </script>
  </body>
</html>
